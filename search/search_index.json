{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"iCliGo Payment API Documentation","text":"<p>This API allows you to manage payment intents, enabling payment capture, cancellations and refunds. </p>"},{"location":"#authentication","title":"Authentication","text":"<p>To authenticate, include the following headers with your API requests: - X-Application-Id: Your application ID. - X-Access-Token: A token used to authenticate your application's access to the API.</p> <p>The API will return a 400 Bad Request response if these headers are missing or invalid. If the payment request is associated with an unauthorised or incorrect Application ID, a 401 Unauthorised response will be returned. If an attempt is made to access a forbidden resource, a 403 Forbidden response is returned.</p>"},{"location":"#errors","title":"Errors","text":"<p>We have normalized the error payload, where all the errors obey the same format in order to be easier to read the error.</p> <p>The error payload includes the following parameters: - timestamp - status - error - message - path</p> Parameter Type Description Example timestamp long Unix timestamp (in milliseconds) when the error occurred 1694181328000 status int HTTP status code of the error 400 error string Brief description of the error type \"Bad Request\" message string Detailed error message providing more information about the error \"Invalid request: missing required fields.\" path string The API endpoint path where the error occurred \"/payments/create-payment-intent\" <p>Error Payload Example: <pre><code>{\n    \"timestamp\": 1727169321150,\n    \"status\": 400,\n    \"error\": \"Bad Request\",\n    \"message\": \"Headers 'X-Access-Token' and 'X-Application-Id' are necessary.\",\n    \"path\": \"/payments/create-payment-intent\"\n}\n</code></pre></p> <p>HTTP Status code summary</p> Code Status Description 200 OK Everything worked as expected. 400 Bad Request The request was unacceptable, often due to missing a required parameter or some auth aspect like the headers. 401 Unauthorized No valid pairs of auth headers was provided. 403 Forbidden The client doesn\u2019t have permissions to perform the request 404 Not Found The requested resource doesn\u2019t exist. 500 Server Errors Something went wrong on iCliGo's end."},{"location":"#payment-flow","title":"Payment Flow","text":""},{"location":"#1-create-payment-intent","title":"1. Create Payment Intent","text":"<p>To initiate a payment, you first need to create a payment intent. This intent holds the necessary information for the payment process.</p> <p>API Endpoint:</p> <ul> <li>Method: POST</li> <li>Path: <code>/payments/create-payment-intent</code></li> </ul>"},{"location":"#request","title":"Request","text":"<p>TODO: Add description context</p> <p>CreateIntentRequest</p> Basic Request Payload Example <pre><code>{\n  \"userId\": \"user_1234\",\n  \"productId\": \"product_1234\",\n  \"productType\": \"BOOKING\",\n  \"products\": [\n    {\n      \"id\": \"prod_001\",\n      \"name\": \"Hotel Room\",\n      \"quantity\": 1,\n      \"price\": {\n        \"currency\": \"EUR\",\n        \"value\": 100.00\n      }\n    }\n  ],\n  \"company\": \"icligo.pt\",\n  \"currency\": \"EUR\",\n  \"microsite\": \"icligo.pt\",\n  \"country\": \"PT\",\n  \"amount\": 25.0\n  \"manualCapture\": false\n}\n</code></pre> Full Payload Example <pre><code>{\n  \"userId\": \"user_1234\",\n  \"productId\": \"product_1234\",\n  \"productType\": \"BOOKING\",\n  \"products\": [\n    {\n      \"id\": \"prod_001\",\n      \"name\": \"Hotel Room\",\n      \"quantity\": 1,\n      \"price\": {\n        \"currency\": \"EUR\",\n        \"value\": 100.00\n      }\n    }\n  ],\n  \"company\": \"icligo.pt\",\n  \"currency\": \"EUR\",\n  \"microsite\": \"icligo.pt\",\n  \"country\": \"PT\",\n  \"amount\": 25.0\n  \"manualCapture\": false\n}\n</code></pre>"},{"location":"#responses","title":"Responses","text":"<p>Success response (200 OK)</p> <p>TODO: Add description context</p> <p>PaymentDto</p> Response Example <pre><code>{\n  \"userId\": \"user_1234\",\n  \"productId\": \"product_1234\",\n  \"productType\": \"BOOKING\",\n  \"products\": [\n    {\n      \"id\": \"prod_001\",\n      \"name\": \"Hotel Room\",\n      \"quantity\": 1,\n      \"price\": {\n        \"currency\": \"EUR\",\n        \"value\": 100.00\n      }\n    }\n  ],\n  \"company\": \"icligo.pt\",\n  \"currency\": \"EUR\",\n  \"microsite\": \"icligo.pt\",\n  \"country\": \"PT\",\n  \"amount\": 25.0\n  \"manualCapture\": false\n}\n</code></pre> <p>Error responses</p> 400 Bad Request The request was unacceptable, often due to missing a required parameter or some auth aspect like the headers. 401 Unauthorized No valid pairs of auth headers was provided. 500 Server Errors Something went wrong on iCliGo's end."},{"location":"#2-payment-page-widget","title":"2. Payment Page / Widget","text":"<p>After creating the payment intent, direct the user to the payment page or widget. This part is abstracted for you. The user will complete the payment, and you will receive a webhook with the payment status: AUTHORIZED (for manual capture) or COMPLETED (for automatic capture).</p>"},{"location":"#3-payment-capture-manual-vs-automatic","title":"3. Payment Capture (Manual vs. Automatic)","text":""},{"location":"#31-manual-payment-flow","title":"3.1 Manual Payment Flow","text":"<p>If manual capture is selected, it\u2019s necessary to proceed with the capture after the payment has been authorized. In automatic capture mode, the capture occurs automatically.</p> <p>In the case of manual capture, the system will send a webhook with the AUTHORIZED status once the user has paid for the order. This indicates that the payment has been authorized and the amount is ready to be captured.</p> <p>Afterward, it's necessary to call the <code>Capture</code> endpoint to complete the operation.</p> <p>API Endpoint:</p> <ul> <li>Method: PUT</li> <li>Path: <code>/payments/{payment_id}/capture</code></li> <li>Path Variables: </li> <li>payment_id: The ID of the payment intent.</li> </ul>"},{"location":"#request_1","title":"Request","text":"<p>The request specifies the amount to be captured and includes an optional description.</p> <p>Request DTO: ExternalConfirmPaymentRequest</p> Request Payload Example <pre><code>{\n    \"amount\": 10.0,\n    \"description\": \"Captured description.\"\n}\n</code></pre>"},{"location":"#responses_1","title":"Responses","text":"<p>Success response (200 OK)</p> <p>The response is an object detailing the date when the capture occurred, along with the captured amount presented as a list of captures.</p> <p>Response DTO: ConfirmPaymentResponse</p> <p>[!TIP] Although the response includes a <code>list</code> of <code>CaptureDetail</code> objects, currently only a single capture is allowed. Therefore, you can expect the list to always contain just one element.</p> Response Example <pre><code>{\n    \"date\": 1727193013453,\n    \"capturedAmountInfo\": {\n        \"currency\": \"EUR\",\n        \"value\": 10.0\n    },\n    \"captures\": [\n        {\n            \"id\": \"66f2df95-659b-a21d-974d-ba3b489d50d9\",\n            \"description\": \"Captured by client\",\n            \"captureTime\": 1727193004172,\n            \"amount\": {\n                \"currency\": \"EUR\",\n                \"value\": 10.0\n            }\n        }\n    ]\n}\n</code></pre> <p>[!NOTE] Upon capture, a CONFIRMED webhook will be sent, indicating that the payment has been successfully confirmed and captured.</p> <p>Error responses</p> Code Description Details 400 Bad Request The request was unacceptable, often due to missing required parameters or incorrect authorization headers. 401 Unauthorized No valid authentication headers were provided. 403 Forbidden The client lacks the necessary permissions to perform the request. 500 Server Error An issue occurred on iCliGo\u2019s side."},{"location":"#32-automatic-capture-payment-flow","title":"3.2 Automatic Capture Payment Flow","text":"<p>In this scenario, the AUTHORIZED webhook is suppressed. When the client pays for the order, a COMPLETED webhook is sent, indicating that the order is completed and the funds have been captured.</p>"},{"location":"#4-cancel-payment","title":"4. Cancel Payment","text":"<p>Cancel a payment only when its status is either Created or Authorized. Payments cannot be canceled once completed.</p>"},{"location":"#5-refund-payment","title":"5. Refund Payment","text":"<p>A payment can only be refunded if it is in the Completed state. Refunds can be partial or full, and multiple refunds are allowed until the total refunded amount equals the original captured amount.</p>"},{"location":"#important-considerations","title":"Important Considerations","text":"<ul> <li>Single Capture: A payment can only be captured once.</li> <li>Refunds: Multiple refunds are allowed but the total refunded amount cannot exceed the captured amount.</li> </ul>"},{"location":"AmountInfo/","title":"AmountInfo","text":""},{"location":"AmountInfo/#properties","title":"Properties","text":"Name Type Description Notes currency String value Number"},{"location":"AuthorizePaymentRequest/","title":"AuthorizePaymentRequest","text":""},{"location":"AuthorizePaymentRequest/#properties","title":"Properties","text":"Name Type Description Notes paymentProvider String klarnaToken String [optional] merchantReference String [optional] country String amountInfo AmountInfo"},{"location":"AuthorizePaymentRequest/#enum-paymentproviderenum","title":"Enum: PaymentProviderEnum","text":"<ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"AuthorizePaymentResponse/","title":"AuthorizePaymentResponse","text":""},{"location":"AuthorizePaymentResponse/#properties","title":"Properties","text":"Name Type Description Notes provider String [optional] status String [optional] _date Date [optional] description String [optional]"},{"location":"AuthorizePaymentResponse/#enum-providerenum","title":"Enum: ProviderEnum","text":"<ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"CaptureDetail/","title":"CaptureDetail","text":""},{"location":"CaptureDetail/#properties","title":"Properties","text":"Name Type Description Notes id String [optional] captureTime Date [optional] amount AmountInfo [optional]"},{"location":"CircuitDto/","title":"CircuitDto","text":""},{"location":"CircuitDto/#properties","title":"Properties","text":"Name Type Description Notes checkin Date [optional] checkout Date [optional] location String [optional]"},{"location":"ClientDto/","title":"ClientDto","text":""},{"location":"ClientDto/#properties","title":"Properties","text":"Name Type Description Notes name String Name of the client. [optional] email String Client's email address. [optional] dateOfBirth Date Client's date of birth, formatted as a string. [optional] children Boolean Indicates if the client is a child. [optional]"},{"location":"ConfirmPaymentResponse/","title":"ConfirmPaymentResponse","text":""},{"location":"ConfirmPaymentResponse/#properties","title":"Properties","text":"Name Type Description Notes status String [optional] _date Date [optional] capturedAmountInfo AmountInfo [optional] description String [optional] captures [CaptureDetail] [optional]"},{"location":"CreateIntentRequest/","title":"CreateIntentRequest","text":""},{"location":"CreateIntentRequest/#properties","title":"Properties","text":"Name Type Description Notes clientId String Unique client identifier. Identifies the client that is making the request, in this case it'syour company/merchant ID agreed at the beginning of the contract. [optional] userId String The user ID associated with the payment. productId String The ID of the product being purchased. productType String Type of the product. resume ResumeDto [optional] products [ProductDto] A list of products associated with the payment. currency String Currency code for the payment. company String Company making the payment request. microsite String The microsite making the payment request. country String Country where the payment is being made. amount Number The amount to be charged."},{"location":"CreateIntentRequest/#enum-producttypeenum","title":"Enum: ProductTypeEnum","text":"<ul> <li><code>BOOKING</code> (value: <code>\"BOOKING\"</code>)</li> <li><code>SUBSCRIPTION</code> (value: <code>\"SUBSCRIPTION\"</code>)</li> <li><code>GIFT</code> (value: <code>\"GIFT\"</code>)</li> <li><code>EVENT</code> (value: <code>\"EVENT\"</code>)</li> <li><code>SERVICE</code> (value: <code>\"SERVICE\"</code>)</li> <li><code>ACCOMMODATION</code> (value: <code>\"ACCOMMODATION\"</code>)</li> <li><code>FLIGHT</code> (value: <code>\"FLIGHT\"</code>)</li> <li><code>PACKAGE</code> (value: <code>\"PACKAGE\"</code>)</li> <li><code>INSURANCE</code> (value: <code>\"INSURANCE\"</code>)</li> <li><code>CRUISE</code> (value: <code>\"CRUISE\"</code>)</li> <li><code>ACTIVITY</code> (value: <code>\"ACTIVITY\"</code>)</li> <li><code>TRANSFER</code> (value: <code>\"TRANSFER\"</code>)</li> </ul>"},{"location":"CreatePaymentResponse/","title":"CreatePaymentResponse","text":""},{"location":"CreatePaymentResponse/#properties","title":"Properties","text":"Name Type Description Notes createdPaymentId String [optional] provider String [optional] require3DSecure Boolean [optional] status String [optional] createdAt Date [optional] reference String [optional] entity String [optional] clientSecret String [optional] clientToken String [optional] amount Number [optional] currency String [optional] redirectUrl String [optional]"},{"location":"CreatePaymentResponse/#enum-providerenum","title":"Enum: ProviderEnum","text":"<ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"DetailDto/","title":"DetailDto","text":""},{"location":"DetailDto/#properties","title":"Properties","text":"Name Type Description Notes night Number Number of nights for the stay. [optional] roomType String Room type for accommodation. [optional] regime String Accommodation regime. [optional] flightNumber String Flight number for associated transportation. [optional] departure Date Departure date for the transportation, formatted as a string. [optional] arrival Date Arrival date for the transportation, formatted as a string. [optional] departureTime String Departure time for the flight or transportation. [optional] arrivalTime String Arrival time for the flight or transportation. [optional] departureAirport String Departure airport code. [optional] arrivalAirport String Arrival airport code. [optional] departureCity String City of departure. [optional] arrivalCity String City of arrival. [optional] departureCountry String Country of departure. [optional] arrivalCountry String Country of arrival. [optional] baggage String Baggage details for the transportation. [optional] duration String Duration of the transportation or stay. [optional] provider String Service provider for the product or service. [optional] reception String Reception details. [optional] receptionTime Date Time of reception at the destination. [optional] destinationTime Date Time of arrival at the destination. [optional] destination String Destination details. [optional] circuit [CircuitDto] Details of the circuit, if applicable. [optional] stopovers [StopoversDto] Details of stopovers during transportation, if applicable. [optional]"},{"location":"DetailDto/#enum-roomtypeenum","title":"Enum: RoomTypeEnum","text":"<ul> <li><code>inside</code> (value: <code>\"Inside\"</code>)</li> <li><code>oceanview</code> (value: <code>\"Oceanview\"</code>)</li> <li><code>balcony</code> (value: <code>\"Balcony\"</code>)</li> <li><code>suite</code> (value: <code>\"Suite\"</code>)</li> </ul>"},{"location":"ErrorPayloadMessage/","title":"ErrorPayloadMessage","text":""},{"location":"ErrorPayloadMessage/#properties","title":"Properties","text":"Name Type Description Notes timestamp Number Timestamp of when the error occurred. [optional] status Number HTTP status code of the error. [optional] error String HTTP description of the error. [optional] message String Detailed error message. [optional] path String The path of the endpoint where the error occurred. [optional] metadata PaymentExceptionPayload [optional]"},{"location":"ExternalConfirmPaymentRequest/","title":"ExternalConfirmPaymentRequest","text":""},{"location":"ExternalConfirmPaymentRequest/#properties","title":"Properties","text":"Name Type Description Notes amountInfo AmountInfo description String [optional]"},{"location":"GiftDto/","title":"GiftDto","text":""},{"location":"GiftDto/#properties","title":"Properties","text":"Name Type Description Notes id Number [optional] value Number [optional] valueToUse Number [optional] code String [optional] clientName String [optional] refund Boolean [optional] fkType Number [optional]"},{"location":"PaymentDto/","title":"PaymentDto","text":""},{"location":"PaymentDto/#properties","title":"Properties","text":"Name Type Description Notes id String Unique identifier for the payment intent. [optional] clientId String Unique client identifier. Identifies the client that is making the request, in this case it'syour company/merchant ID agreed at the beginning of the contract. [optional] userId String User/Customer identifier who initiated the payment. [optional] service String Service associated with the payment. [optional] serviceDescription String Detailed description of the service. [optional] productId String Product identifier related to the payment. [optional] productType String Type of the product for which the payment is being made. [optional] resume ResumeDto [optional] products [ProductDto] List of products associated with this payment. [optional] company String Company associated with the payment. [optional] microsite String Microsite used for making the payment. [optional] country String Country where the payment is being made. [optional] currency String Currency used for the payment. [optional] createdBy String Username of the person who created the payment. [optional] state String Current state of the payment. [optional] amount Number Total amount of the order. [optional] capturedAmount Number Amount captured. [optional] authorizedAmount Number Amount authorized to be captured. [optional] methodTax Number Tax applied to the payment method. [optional] captureDetails [CaptureDetail] Details of the captures made for the payment. [optional] refundDetails [RefundDetail] Details of any refunds made for the payment. [optional] expirationDate Date Expiration date of the payment. [optional] gifts [GiftDto] Details of the gifts/vouchers used for the payment. [optional] isFullyPaidWithGifts Boolean The payment is fully paid with gifts. [optional]"},{"location":"PaymentDto/#enum-producttypeenum","title":"Enum: ProductTypeEnum","text":"<ul> <li><code>BOOKING</code> (value: <code>\"BOOKING\"</code>)</li> <li><code>SUBSCRIPTION</code> (value: <code>\"SUBSCRIPTION\"</code>)</li> <li><code>GIFT</code> (value: <code>\"GIFT\"</code>)</li> <li><code>EVENT</code> (value: <code>\"EVENT\"</code>)</li> <li><code>SERVICE</code> (value: <code>\"SERVICE\"</code>)</li> <li><code>ACCOMMODATION</code> (value: <code>\"ACCOMMODATION\"</code>)</li> <li><code>FLIGHT</code> (value: <code>\"FLIGHT\"</code>)</li> <li><code>PACKAGE</code> (value: <code>\"PACKAGE\"</code>)</li> <li><code>INSURANCE</code> (value: <code>\"INSURANCE\"</code>)</li> <li><code>CRUISE</code> (value: <code>\"CRUISE\"</code>)</li> <li><code>ACTIVITY</code> (value: <code>\"ACTIVITY\"</code>)</li> <li><code>TRANSFER</code> (value: <code>\"TRANSFER\"</code>)</li> </ul>"},{"location":"PaymentDto/#enum-stateenum","title":"Enum: StateEnum","text":"<ul> <li><code>CREATED</code> (value: <code>\"CREATED\"</code>)</li> <li><code>PROCESSING</code> (value: <code>\"PROCESSING\"</code>)</li> <li><code>AUTHORIZED</code> (value: <code>\"AUTHORIZED\"</code>)</li> <li><code>COMPLETED</code> (value: <code>\"COMPLETED\"</code>)</li> <li><code>CANCELED</code> (value: <code>\"CANCELED\"</code>)</li> <li><code>FAILED</code> (value: <code>\"FAILED\"</code>)</li> <li><code>REFUNDED</code> (value: <code>\"REFUNDED\"</code>)</li> </ul>"},{"location":"PaymentExceptionPayload/","title":"PaymentExceptionPayload","text":""},{"location":"PaymentExceptionPayload/#properties","title":"Properties","text":"Name Type Description Notes translationKey String Key used for translating the error message. [optional] message String Detailed error message related to the payment exception. [optional] action String Action to be taken based on the payment exception. [optional]"},{"location":"PaymentExceptionPayload/#enum-translationkeyenum","title":"Enum: TranslationKeyEnum","text":"<ul> <li><code>PAYMENT_API_ERROR_NAME</code> (value: <code>\"PAYMENT_API_ERROR_NAME\"</code>)</li> <li><code>PAYMENT_API_ERROR_FIELD</code> (value: <code>\"PAYMENT_API_ERROR_FIELD\"</code>)</li> <li><code>PAYMENT_API_ERROR_CREATING_ORDER</code> (value: <code>\"PAYMENT_API_ERROR_CREATING_ORDER\"</code>)</li> <li><code>PAYMENT_API_ERROR_STATE</code> (value: <code>\"PAYMENT_API_ERROR_STATE\"</code>)</li> <li><code>GIFT_API_ERROR</code> (value: <code>\"GIFT_API_ERROR\"</code>)</li> <li><code>PAYMENT_API_ERROR_CAPTURE</code> (value: <code>\"PAYMENT_API_ERROR_CAPTURE\"</code>)</li> <li><code>PAYMENT_API_ERROR_CANCELLATION</code> (value: <code>\"PAYMENT_API_ERROR_CANCELLATION\"</code>)</li> <li><code>PAYMENT_API_ERROR_REFUND</code> (value: <code>\"PAYMENT_API_ERROR_REFUND\"</code>)</li> <li><code>PAYMENT_API_ID_NOT_FOUND</code> (value: <code>\"PAYMENT_API_ID_NOT_FOUND\"</code>)</li> <li><code>PAYMENT_API_INVALID_SELECTED_METHOD</code> (value: <code>\"PAYMENT_API_INVALID_SELECTED_METHOD\"</code>)</li> <li><code>PAYMENT_API_ALREADY_CANCELLED</code> (value: <code>\"PAYMENT_API_ALREADY_CANCELLED\"</code>)</li> <li><code>PAYMENT_API_TIMEOUT</code> (value: <code>\"PAYMENT_API_TIMEOUT\"</code>)</li> </ul>"},{"location":"PaymentExceptionPayload/#enum-actionenum","title":"Enum: ActionEnum","text":"<ul> <li><code>INFO</code> (value: <code>\"INFO\"</code>)</li> <li><code>WARNING</code> (value: <code>\"WARNING\"</code>)</li> <li><code>CLOSE</code> (value: <code>\"CLOSE\"</code>)</li> </ul>"},{"location":"ProductDto/","title":"ProductDto","text":""},{"location":"ProductDto/#properties","title":"Properties","text":"Name Type Description Notes type String Type of the product. [optional] name String Name of the product. [optional] location String Location of the product. [optional] duration String Duration of the product/service. [optional] code String Unique product code. [optional] transport String Type of transport associated with the product, if applicable. [optional] checkin Date Check-in date of the product, formatted as a string. [optional] checkout Date Check-out date of the product, formatted as a string. [optional] _date Date Date of the product activity or service, formatted as a string. [optional] price Number Price of the product. [optional] detail DetailDto [optional]"},{"location":"ProductDto/#enum-typeenum","title":"Enum: TypeEnum","text":"<ul> <li><code>BOOKING</code> (value: <code>\"BOOKING\"</code>)</li> <li><code>SUBSCRIPTION</code> (value: <code>\"SUBSCRIPTION\"</code>)</li> <li><code>GIFT</code> (value: <code>\"GIFT\"</code>)</li> <li><code>EVENT</code> (value: <code>\"EVENT\"</code>)</li> <li><code>SERVICE</code> (value: <code>\"SERVICE\"</code>)</li> <li><code>ACCOMMODATION</code> (value: <code>\"ACCOMMODATION\"</code>)</li> <li><code>FLIGHT</code> (value: <code>\"FLIGHT\"</code>)</li> <li><code>PACKAGE</code> (value: <code>\"PACKAGE\"</code>)</li> <li><code>INSURANCE</code> (value: <code>\"INSURANCE\"</code>)</li> <li><code>CRUISE</code> (value: <code>\"CRUISE\"</code>)</li> <li><code>ACTIVITY</code> (value: <code>\"ACTIVITY\"</code>)</li> <li><code>TRANSFER</code> (value: <code>\"TRANSFER\"</code>)</li> </ul>"},{"location":"ProductDto/#enum-transportenum","title":"Enum: TransportEnum","text":"<ul> <li><code>CAR</code> (value: <code>\"CAR\"</code>)</li> <li><code>BUS</code> (value: <code>\"BUS\"</code>)</li> <li><code>TRAIN</code> (value: <code>\"TRAIN\"</code>)</li> </ul>"},{"location":"RefundDetail/","title":"RefundDetail","text":""},{"location":"RefundDetail/#properties","title":"Properties","text":"Name Type Description Notes id String [optional] captureId String [optional] createTime Date [optional] description String [optional] amount AmountInfo [optional]"},{"location":"RefundEndpointPaymentRequest/","title":"RefundEndpointPaymentRequest","text":""},{"location":"RefundEndpointPaymentRequest/#properties","title":"Properties","text":"Name Type Description Notes amountInfo AmountInfo description String [optional]"},{"location":"ResumeDto/","title":"ResumeDto","text":""},{"location":"ResumeDto/#properties","title":"Properties","text":"Name Type Description Notes description String Description of the product or service. [optional] reference String Reference ID for the product or service. [optional] owner String Owner or responsible party for the transaction. [optional] email String Owner's contact email address. [optional] currency String Currency code for the transaction. [optional] amount Number Total amount of the transaction. [optional] checkin Date Check-in date for the booking, formatted as a string. [optional] checkout Date Check-out date for the booking, formatted as a string. [optional] clients [ClientDto] List of clients involved in the transaction. [optional]"},{"location":"SelectPaymentMethodRequest/","title":"SelectPaymentMethodRequest","text":""},{"location":"SelectPaymentMethodRequest/#properties","title":"Properties","text":"Name Type Description Notes paymentMethod String provider String mbWayNumber String [optional] stripeMethodId String [optional]"},{"location":"SelectPaymentMethodRequest/#enum-paymentmethodenum","title":"Enum: PaymentMethodEnum","text":"<ul> <li><code>VISA</code> (value: <code>\"VISA\"</code>)</li> <li><code>PAYPAL</code> (value: <code>\"PAYPAL\"</code>)</li> <li><code>MASTERCARD</code> (value: <code>\"MASTERCARD\"</code>)</li> <li><code>AMERICANEXPRESS</code> (value: <code>\"AMERICANEXPRESS\"</code>)</li> <li><code>MULTIBANCO</code> (value: <code>\"MULTIBANCO\"</code>)</li> <li><code>MBWAY</code> (value: <code>\"MBWAY\"</code>)</li> <li><code>KLARNA</code> (value: <code>\"KLARNA\"</code>)</li> <li><code>ICLIGOGIFT</code> (value: <code>\"ICLIGOGIFT\"</code>)</li> </ul>"},{"location":"SelectPaymentMethodRequest/#enum-providerenum","title":"Enum: ProviderEnum","text":"<ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"StopoversDto/","title":"StopoversDto","text":""},{"location":"StopoversDto/#properties","title":"Properties","text":"Name Type Description Notes departure Date [optional] arrival Date [optional] departureTime String [optional] arrivalTime String [optional] departureAirport String [optional] arrivalAirport String [optional] departureCity String [optional] arrivalCity String [optional] departureCountry String [optional] arrivalCountry String [optional] duration String [optional]"},{"location":"dtos/","title":"DTOs","text":"<p>The following section defines the Data Transfer Objects (DTOs) used in our system. DTOs are simple objects designed to carry data between processes without containing any business logic. These objects ensure efficient data exchange between different layers or services while keeping the system modular and maintainable. Below is a list of the DTOs and their respective fields, which are used throughout the application.</p>"},{"location":"dtos/#amountinfo","title":"AmountInfo","text":"<p>Properties</p> Name Type Description Notes currency String value Number"},{"location":"dtos/#authorizepaymentrequest","title":"AuthorizePaymentRequest","text":"<p>Properties</p> Name Type Description Notes paymentProvider String klarnaToken String [optional] merchantReference String [optional] country String amountInfo AmountInfo <p> Enum: PaymentProviderEnum</p> <ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"dtos/#authorizepaymentresponse","title":"AuthorizePaymentResponse","text":"<p>Properties</p> Name Type Description Notes provider String [optional] status String [optional] _date Date [optional] description String [optional] <p> Enum: ProviderEnum</p> <ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"dtos/#capturedetail","title":"CaptureDetail","text":"<p>Properties</p> Name Type Description Notes id String [optional] captureTime Date [optional] amount AmountInfo [optional]"},{"location":"dtos/#circuitdto","title":"CircuitDto","text":"<p>Properties</p> Name Type Description Notes checkin Date [optional] checkout Date [optional] location String [optional]"},{"location":"dtos/#clientdto","title":"ClientDto","text":"<p>Properties</p> Name Type Description Notes name String Name of the client. [optional] email String Client's email address. [optional] dateOfBirth Date Client's date of birth, formatted as a string. [optional] children Boolean Indicates if the client is a child. [optional]"},{"location":"dtos/#confirmpaymentresponse","title":"ConfirmPaymentResponse","text":"<p>Properties</p> Name Type Description Notes status String [optional] _date Date [optional] capturedAmountInfo AmountInfo [optional] description String [optional] captures CaptureDetail [optional]"},{"location":"dtos/#detaildto","title":"DetailDto","text":"<p>Properties</p> Name Type Description Notes night Number Number of nights for the stay. [optional] roomType String Room type for accommodation. [optional] regime String Accommodation regime. [optional] flightNumber String Flight number for associated transportation. [optional] departure Date Departure date for the transportation, formatted as a string. [optional] arrival Date Arrival date for the transportation, formatted as a string. [optional] departureTime String Departure time for the flight or transportation. [optional] arrivalTime String Arrival time for the flight or transportation. [optional] departureAirport String Departure airport code. [optional] arrivalAirport String Arrival airport code. [optional] departureCity String City of departure. [optional] arrivalCity String City of arrival. [optional] departureCountry String Country of departure. [optional] arrivalCountry String Country of arrival. [optional] baggage String Baggage details for the transportation. [optional] duration String Duration of the transportation or stay. [optional] provider String Service provider for the product or service. [optional] reception String Reception details. [optional] receptionTime Date Time of reception at the destination. [optional] destinationTime Date Time of arrival at the destination. [optional] destination String Destination details. [optional] circuit CircuitDto Details of the circuit, if applicable. [optional] stopovers StopoversDto Details of stopovers during transportation, if applicable. [optional] <p> Enum: RoomTypeEnum</p> <ul> <li><code>inside</code> (value: <code>\"Inside\"</code>)</li> <li><code>oceanview</code> (value: <code>\"Oceanview\"</code>)</li> <li><code>balcony</code> (value: <code>\"Balcony\"</code>)</li> <li><code>suite</code> (value: <code>\"Suite\"</code>)</li> </ul>"},{"location":"dtos/#errorpayloadmessage","title":"ErrorPayloadMessage","text":"<p>Properties</p> Name Type Description Notes timestamp Number Timestamp of when the error occurred. [optional] status Number HTTP status code of the error. [optional] error String HTTP description of the error. [optional] message String Detailed error message. [optional] path String The path of the endpoint where the error occurred. [optional] metadata PaymentExceptionPayload [optional]"},{"location":"dtos/#externalconfirmpaymentrequest","title":"ExternalConfirmPaymentRequest","text":"<p>Properties</p> Name Type Description Notes amountInfo AmountInfo description String [optional]"},{"location":"dtos/#giftdto","title":"GiftDto","text":"<p>Properties</p> Name Type Description Notes id Number [optional] value Number [optional] valueToUse Number [optional] code String [optional] clientName String [optional] refund Boolean [optional] fkType Number [optional]"},{"location":"dtos/#paymentdto","title":"PaymentDto","text":"<p>Properties</p> Name Type Description Notes id String Unique identifier for the payment intent. [optional] clientId String Unique client identifier. Identifies the client that is making the request, in this case it'syour company/merchant ID agreed at the beginning of the contract. [optional] userId String User/Customer identifier who initiated the payment. [optional] service String Service associated with the payment. [optional] serviceDescription String Detailed description of the service. [optional] productId String Product identifier related to the payment. [optional] productType String Type of the product for which the payment is being made. [optional] resume ResumeDto [optional] products ProductDto List of products associated with this payment. [optional] company String Company associated with the payment. [optional] microsite String Microsite used for making the payment. [optional] country String Country where the payment is being made. [optional] currency String Currency used for the payment. [optional] createdBy String Username of the person who created the payment. [optional] state String Current state of the payment. [optional] amount Number Total amount of the order. [optional] capturedAmount Number Amount captured. [optional] authorizedAmount Number Amount authorized to be captured. [optional] methodTax Number Tax applied to the payment method. [optional] captureDetails CaptureDetail Details of the captures made for the payment. [optional] refundDetails RefundDetail Details of any refunds made for the payment. [optional] expirationDate Date Expiration date of the payment. [optional] gifts GiftDto Details of the gifts/vouchers used for the payment. [optional] isFullyPaidWithGifts Boolean The payment is fully paid with gifts. [optional] <p> Enum: ProductTypeEnum</p> <ul> <li><code>BOOKING</code> (value: <code>\"BOOKING\"</code>)</li> <li><code>SUBSCRIPTION</code> (value: <code>\"SUBSCRIPTION\"</code>)</li> <li><code>GIFT</code> (value: <code>\"GIFT\"</code>)</li> <li><code>EVENT</code> (value: <code>\"EVENT\"</code>)</li> <li><code>SERVICE</code> (value: <code>\"SERVICE\"</code>)</li> <li><code>ACCOMMODATION</code> (value: <code>\"ACCOMMODATION\"</code>)</li> <li><code>FLIGHT</code> (value: <code>\"FLIGHT\"</code>)</li> <li><code>PACKAGE</code> (value: <code>\"PACKAGE\"</code>)</li> <li><code>INSURANCE</code> (value: <code>\"INSURANCE\"</code>)</li> <li><code>CRUISE</code> (value: <code>\"CRUISE\"</code>)</li> <li><code>ACTIVITY</code> (value: <code>\"ACTIVITY\"</code>)</li> <li><code>TRANSFER</code> (value: <code>\"TRANSFER\"</code>)</li> </ul> <p> Enum: StateEnum</p> <ul> <li><code>CREATED</code> (value: <code>\"CREATED\"</code>)</li> <li><code>PROCESSING</code> (value: <code>\"PROCESSING\"</code>)</li> <li><code>AUTHORIZED</code> (value: <code>\"AUTHORIZED\"</code>)</li> <li><code>COMPLETED</code> (value: <code>\"COMPLETED\"</code>)</li> <li><code>CANCELED</code> (value: <code>\"CANCELED\"</code>)</li> <li><code>FAILED</code> (value: <code>\"FAILED\"</code>)</li> <li><code>REFUNDED</code> (value: <code>\"REFUNDED\"</code>)</li> </ul>"},{"location":"dtos/#paymentexceptionpayload","title":"PaymentExceptionPayload","text":"<p>Properties</p> Name Type Description Notes translationKey String Key used for translating the error message. [optional] message String Detailed error message related to the payment exception. [optional] action String Action to be taken based on the payment exception. [optional] <p> Enum: TranslationKeyEnum</p> <ul> <li><code>PAYMENT_API_ERROR_NAME</code> (value: <code>\"PAYMENT_API_ERROR_NAME\"</code>)</li> <li><code>PAYMENT_API_ERROR_FIELD</code> (value: <code>\"PAYMENT_API_ERROR_FIELD\"</code>)</li> <li><code>PAYMENT_API_ERROR_CREATING_ORDER</code> (value: <code>\"PAYMENT_API_ERROR_CREATING_ORDER\"</code>)</li> <li><code>PAYMENT_API_ERROR_STATE</code> (value: <code>\"PAYMENT_API_ERROR_STATE\"</code>)</li> <li><code>GIFT_API_ERROR</code> (value: <code>\"GIFT_API_ERROR\"</code>)</li> <li><code>PAYMENT_API_ERROR_CAPTURE</code> (value: <code>\"PAYMENT_API_ERROR_CAPTURE\"</code>)</li> <li><code>PAYMENT_API_ERROR_CANCELLATION</code> (value: <code>\"PAYMENT_API_ERROR_CANCELLATION\"</code>)</li> <li><code>PAYMENT_API_ERROR_REFUND</code> (value: <code>\"PAYMENT_API_ERROR_REFUND\"</code>)</li> <li><code>PAYMENT_API_ID_NOT_FOUND</code> (value: <code>\"PAYMENT_API_ID_NOT_FOUND\"</code>)</li> <li><code>PAYMENT_API_INVALID_SELECTED_METHOD</code> (value: <code>\"PAYMENT_API_INVALID_SELECTED_METHOD\"</code>)</li> <li><code>PAYMENT_API_ALREADY_CANCELLED</code> (value: <code>\"PAYMENT_API_ALREADY_CANCELLED\"</code>)</li> <li><code>PAYMENT_API_TIMEOUT</code> (value: <code>\"PAYMENT_API_TIMEOUT\"</code>)</li> </ul> <p> Enum: ActionEnum</p> <ul> <li><code>INFO</code> (value: <code>\"INFO\"</code>)</li> <li><code>WARNING</code> (value: <code>\"WARNING\"</code>)</li> <li><code>CLOSE</code> (value: <code>\"CLOSE\"</code>)</li> </ul>"},{"location":"dtos/#productdto","title":"ProductDto","text":"<p>Properties</p> Name Type Description Notes type String Type of the product. [optional] name String Name of the product. [optional] location String Location of the product. [optional] duration String Duration of the product/service. [optional] code String Unique product code. [optional] transport String Type of transport associated with the product, if applicable. [optional] checkin Date Check-in date of the product, formatted as a string. [optional] checkout Date Check-out date of the product, formatted as a string. [optional] _date Date Date of the product activity or service, formatted as a string. [optional] price Number Price of the product. [optional] detail DetailDto [optional] <p> Enum: TypeEnum</p> <ul> <li><code>BOOKING</code> (value: <code>\"BOOKING\"</code>)</li> <li><code>SUBSCRIPTION</code> (value: <code>\"SUBSCRIPTION\"</code>)</li> <li><code>GIFT</code> (value: <code>\"GIFT\"</code>)</li> <li><code>EVENT</code> (value: <code>\"EVENT\"</code>)</li> <li><code>SERVICE</code> (value: <code>\"SERVICE\"</code>)</li> <li><code>ACCOMMODATION</code> (value: <code>\"ACCOMMODATION\"</code>)</li> <li><code>FLIGHT</code> (value: <code>\"FLIGHT\"</code>)</li> <li><code>PACKAGE</code> (value: <code>\"PACKAGE\"</code>)</li> <li><code>INSURANCE</code> (value: <code>\"INSURANCE\"</code>)</li> <li><code>CRUISE</code> (value: <code>\"CRUISE\"</code>)</li> <li><code>ACTIVITY</code> (value: <code>\"ACTIVITY\"</code>)</li> <li><code>TRANSFER</code> (value: <code>\"TRANSFER\"</code>)</li> </ul> <p> Enum: TransportEnum</p> <ul> <li><code>CAR</code> (value: <code>\"CAR\"</code>)</li> <li><code>BUS</code> (value: <code>\"BUS\"</code>)</li> <li><code>TRAIN</code> (value: <code>\"TRAIN\"</code>)</li> </ul>"},{"location":"dtos/#refunddetail","title":"RefundDetail","text":"<p>Properties</p> Name Type Description Notes id String [optional] captureId String [optional] createTime Date [optional] description String [optional] amount AmountInfo [optional]"},{"location":"dtos/#refundendpointpaymentrequest","title":"RefundEndpointPaymentRequest","text":"<p>Properties</p> Name Type Description Notes amountInfo AmountInfo description String [optional]"},{"location":"dtos/#resumedto","title":"ResumeDto","text":"<p>Properties</p> Name Type Description Notes description String Description of the product or service. [optional] reference String Reference ID for the product or service. [optional] owner String Owner or responsible party for the transaction. [optional] email String Owner's contact email address. [optional] currency String Currency code for the transaction. [optional] amount Number Total amount of the transaction. [optional] checkin Date Check-in date for the booking, formatted as a string. [optional] checkout Date Check-out date for the booking, formatted as a string. [optional] clients ClientDto List of clients involved in the transaction. [optional]"},{"location":"dtos/#selectpaymentmethodrequest","title":"SelectPaymentMethodRequest","text":"<p>Properties</p> Name Type Description Notes paymentMethod String provider String mbWayNumber String [optional] stripeMethodId String [optional] <p> Enum: PaymentMethodEnum</p> <ul> <li><code>VISA</code> (value: <code>\"VISA\"</code>)</li> <li><code>PAYPAL</code> (value: <code>\"PAYPAL\"</code>)</li> <li><code>MASTERCARD</code> (value: <code>\"MASTERCARD\"</code>)</li> <li><code>AMERICANEXPRESS</code> (value: <code>\"AMERICANEXPRESS\"</code>)</li> <li><code>MULTIBANCO</code> (value: <code>\"MULTIBANCO\"</code>)</li> <li><code>MBWAY</code> (value: <code>\"MBWAY\"</code>)</li> <li><code>KLARNA</code> (value: <code>\"KLARNA\"</code>)</li> <li><code>ICLIGOGIFT</code> (value: <code>\"ICLIGOGIFT\"</code>)</li> </ul> <p> Enum: ProviderEnum</p> <ul> <li><code>STRIPE_PT</code> (value: <code>\"STRIPE_PT\"</code>)</li> <li><code>VIVAWALLET_PT</code> (value: <code>\"VIVAWALLET_PT\"</code>)</li> <li><code>IFTHEN_PT</code> (value: <code>\"IFTHEN_PT\"</code>)</li> <li><code>PAYPAL_PT</code> (value: <code>\"PAYPAL_PT\"</code>)</li> <li><code>PAYPAL_US</code> (value: <code>\"PAYPAL_US\"</code>)</li> <li><code>REVOLUT_PT</code> (value: <code>\"REVOLUT_PT\"</code>)</li> <li><code>KLARNA_PT</code> (value: <code>\"KLARNA_PT\"</code>)</li> <li><code>ICLIGO</code> (value: <code>\"ICLIGO\"</code>)</li> </ul>"},{"location":"dtos/#stopoversdto","title":"StopoversDto","text":"<p>Properties</p> Name Type Description Notes departure Date [optional] arrival Date [optional] departureTime String [optional] arrivalTime String [optional] departureAirport String [optional] arrivalAirport String [optional] departureCity String [optional] arrivalCity String [optional] departureCountry String [optional] arrivalCountry String [optional] duration String [optional]"},{"location":"starting/","title":"Getting started","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"starting/#code-annotation-examples","title":"Code Annotation Examples","text":""},{"location":"webhooks/","title":"Webhooks","text":"<p>This document describes our strategies for ensuring reliable webhook delivery to our clients. It details the methods we employ to guarantee the integrity and confidentiality of webhook transmissions, the structure of the payload we send, and the process for confirming successful delivery of the webhooks.</p>"},{"location":"webhooks/#content","title":"Content","text":"<ul> <li>Payload Structure</li> <li>Security and Verification</li> <li>Webhook Delivery Confirmation</li> </ul>"},{"location":"webhooks/#payload-structure","title":"Payload Structure","text":"<p>The webhook payload consists of two main parts:</p> <ol> <li>payload: Contains the event details.</li> <li>metadata: Contains additional information for verifying the authenticity of the payload.</li> </ol> <p>An example payload is shown below:</p> <pre><code>{\n  \"payload\": {\n    \"event\": \"PAYMENT_AUTHORIZED\",\n    \"reference\": \"your-product-reference\",\n    \"payment-id\": \"payment-order-id\"\n  },\n  \"metadata\": {\n    \"signature\": \"CxyPzcjL9SPiXZGFpKp+/p6Lj1GciIQ3owm{...}fgULDtJ3YUsdweCirc9IJf2VEO4gBwEV2xw==\",\n    \"timestamp\": \"1721317618422\",\n    \"keyword\": \"secret-key\"\n  }\n}\n</code></pre>"},{"location":"webhooks/#fields","title":"Fields","text":""},{"location":"webhooks/#payload","title":"Payload","text":"<p>The payload contains information about the event and has a consistent format across all events.</p> Field Description Type event The type of event being reported. String reference The client's reference. String payment-id Our unique payment order identification. String <p>The possible events are:</p> <ul> <li>PAYMENT_AUTHORIZED: The payment is authorized.</li> <li>PAYMENT_COMPLETED: The payment it was completed (captured).</li> <li>PAYMENT_CANCELLED: The payment was cancelled.</li> </ul>"},{"location":"webhooks/#metadata","title":"Metadata","text":"<p>The metadata contains information for verifying the authenticity of the payload.</p> Field Description Type signature A base64 RSA digital signature. String timestamp The timestamp when the payload was created, in Unix epoch milliseconds. String keyword An agreed-upon secret keyword. String"},{"location":"webhooks/#security-and-verification","title":"Security and Verification","text":"<p>To verify the authenticity of the webhooks, we employ two strategies: the Keyword strategy and the Signature strategy.</p>"},{"location":"webhooks/#keyword-strategy","title":"Keyword Strategy","text":"<p>This straightforward strategy involves using an agreed-upon keyword to verify the authenticity of the payload.</p> <p>Steps to Verify:</p> <ol> <li>Save the keyword: Store the agreed-upon keyword.</li> <li>Compare the keyword: When receiving the request, compare the keyword in the payload with the stored keyword to ensure they match.</li> </ol>"},{"location":"webhooks/#signature-strategy","title":"Signature Strategy","text":"<p>This more secure strategy involves digital signatures and RSA public keys.</p> <p>Steps to Verify:</p> <ol> <li>Save the public key: After subscribing to our webhooks, you will receive an RSA public key in the PKCS8 format. Store this key securely.</li> <li>Hash the payload: </li> <li> <p>Remove all spaces from the raw payload to normalize it. </p> <p>Raw payload: <pre><code>{\n  \"event\": \"PAYMENT_AUTHORIZED\",\n  \"reference\": \"reference-id\",\n  \"payment-id\": \"d76d1fcb-9a9e-489b-a71b-25304c2d8c5c\"\n}\n</code></pre></p> <p>Processed payload: <pre><code>{\"event\":\"PAYMENT_AUTHORIZED\",\"reference\":\"reference-id\",\"payment-id\":\"d76d1fcb-9a9e-489b-a71b-25304c2d8c5c\"}\n</code></pre>    - Generate a SHA-256 hash of the processed payload. For example:  <pre><code>e9f77536b9fc6ec2853fdd4d0026ca29541e741b225d8ce9107e612350149a15\n</code></pre> 3. Verify the signature: Use the stored public key, the generated payload hash, and the signature provided in the metadata to verify the signature.</p> <ul> <li>Load the public key into the program.</li> <li>Verify the signature using the <code>SHA512 RSA</code> algorithm.</li> </ul> </li> </ol> <p>Note: Be careful to use the correct algorithms! The signature is using <code>SHA512 RSA</code>, the public key is in the <code>PKCS8</code> format, and the hash is generated with <code>SHA-256</code>.</p> <p>Example Code of Signature Strategy</p> <p>Java</p> <pre><code>import java.nio.charset.StandardCharsets;\nimport java.security.KeyFactory;\nimport java.security.MessageDigest;\nimport java.security.PublicKey;\nimport java.security.Signature;\nimport java.security.spec.X509EncodedKeySpec;\nimport java.util.Base64;\n\nclass PayloadValidation {\n\n    private static PublicKey parsePublicKey(String publicKeyString) throws Exception {\n        publicKeyString = publicKeyString\n                .replace(\"\\n\", \"\")\n                .replace(\"-----END PUBLIC KEY-----\", \"\")\n                .replace(\"-----BEGIN PUBLIC KEY-----\", \"\");\n\n        byte[] publicKeyBytes = Base64.getDecoder().decode(publicKeyString);\n        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicKeyBytes);\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\n        return keyFactory.generatePublic(keySpec);\n    }\n\n    private static boolean verifyMessage(String publicKeyStr, String plainText, String signature) throws Exception {\n        Signature publicSignature = Signature.getInstance(\"SHA512withRSA\");\n        PublicKey publicKey = parsePublicKey(publicKeyStr);\n        publicSignature.initVerify(publicKey);\n        publicSignature.update(plainText.getBytes(StandardCharsets.UTF_8));\n        byte[] signatureBytes = Base64.getDecoder().decode(signature);\n        return publicSignature.verify(signatureBytes);\n    }\n\n    public static String generateSHA256Hash(String string) throws Exception {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        byte[] encodedHash = digest.digest(string.getBytes(StandardCharsets.UTF_8));\n        return bytesToHex(encodedHash);\n    }\n\n    private static String bytesToHex(byte[] hash) {\n        StringBuilder hexString = new StringBuilder(2 * hash.length);\n        for (byte b : hash) {\n            String hex = Integer.toHexString(0xff &amp; b);\n            if (hex.length() == 1) {\n                hexString.append('0');\n            }\n            hexString.append(hex);\n        }\n        return hexString.toString();\n    }\n\n    public static void main(String[] args) {\n        String signature = \"signature\";\n        String publicKeyStr = \"public key\";\n        String payloadStr = \"{\\\"event\\\":\\\"PAYMENT_AUTHORIZED\\\",\\\"reference\\\":\\\"reference-id\\\",\\\"payment-id\\\":\\\"d76d1fcb-9a9e-489b-a71b-25304c2d8c5c\\\"}\";\n\n        try {\n            String payloadHash = generateSHA256Hash(payloadStr);\n            boolean isValid = verifyMessage(publicKeyStr, payloadHash, signature);\n            System.out.println(\"The signature is \" + (isValid ? \"valid\" : \"invalid\"));\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>Python</p> <pre><code>import base64\nimport hashlib\n\nfrom cryptography.exceptions import InvalidSignature\nfrom cryptography.hazmat.primitives import hashes\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import padding\n\n\ndef generate_sha256_hash(string):\n    return hashlib.sha256(string.encode('utf-8')).hexdigest()\n\n\n# Load the public key\npublic_key_pem = b\"\"\"-----BEGIN PUBLIC KEY-----\nyour-public-key\n-----END PUBLIC KEY-----\"\"\"\npublic_key = serialization.load_pem_public_key(public_key_pem)\n\n# Decode the signature\ndecoded_signature = base64.b64decode(\"the signature\")\n\n# Hash the payload\npayload = '{\"event\":\"PAYMENT_AUTHORIZED\",\"reference\":\"reference-id\",\"payment-id\":\"d76d1fcb-9a9e-489b-a71b-25304c2d8c5c\"}'\npayload_hash = generate_sha256_hash(payload)\n\n# Verify the signature\ntry:\n    public_key.verify(\n        decoded_signature,\n        payload_hash.encode('utf-8'),\n        padding.PKCS1v15(),\n        hashes.SHA512()\n    )\n    print(\"The signature is valid.\")\nexcept InvalidSignature:\n    print(\"The signature is invalid.\")\n</code></pre>"},{"location":"webhooks/#webhook-delivery-confirmation","title":"Webhook Delivery Confirmation","text":"<p>To ensure reliable delivery of webhooks, we implement a retry mechanism and notification system. </p>"},{"location":"webhooks/#confirming-successful-reception","title":"Confirming Successful Reception","text":"<p>A webhook is considered successfully delivered when the client's server responds with an HTTP status code in the <code>2XX</code> range. Specifically:</p> <ul> <li>Status codes <code>200-299</code> indicate successful reception.</li> <li>Any status code outside this range (e.g., <code>3XX</code>, <code>4XX</code>, <code>5XX</code>) is treated as a failed delivery and it will be considered as a non delivery webhook.</li> </ul>"},{"location":"webhooks/#retry-mechanism","title":"Retry Mechanism","text":"<p>If the initial webhook delivery attempt fails, our system automatically initiates a series of retry attempts:</p> <p>Retries are performed at increasing intervals:</p> <ul> <li>5 tries </li> <li>With a backoff ratio of 1.1 over a 15 seconds interval</li> <li>Trigger rate, approximately, in seconds: 0, ~15, ~32, ~50, ~70</li> </ul>"},{"location":"webhooks/#notification-process-for-persistent-failures","title":"Notification Process for Persistent Failures","text":"<p>If all retry attempts are exhausted without a successful delivery, our system triggers a notification process:</p> <ol> <li>Notifications are sent to a predefined list of email addresses associated with the client's webhook configuration.</li> <li>This email list is established during the initial webhook setup process.</li> <li>The notification email includes:</li> <li>Details of the failed webhook, like:<ul> <li>Timestamp</li> <li>Payment and order reference</li> <li>Event type</li> </ul> </li> </ol>"}]}